{% extends "layout2.html" %}
{% block title %}<title>Classification</title>{% endblock %}

{% block content %}
<h1>Cowrie Log Attack Type Classification</h1>

<p class="comment">Please check your cowrie log data and enter! Note that you only need to fill in blocks with values!</p>

<!-- Form to input parameters -->
<form method="POST" action="{% url 'ask_me:classification' %}">
    {% csrf_token %}
    <div class="form-flex-classification">
        <div class="form-group">
            <label for="username">Username:</label>
            <input type="text" id="username" name="username" class="form-control" placeholder="" value="{{ request.POST.username }}">
        </div>
        <div class="form-group">
            <label for="input">Input:</label>
            <input type="text" id="input" name="input" class="form-control" placeholder="" value="{{ request.POST.input }}">
        </div>
        <div class="form-group">
            <label for="protocol">Protocol:</label>
            <input type="text" id="protocol" name="protocol" class="form-control" placeholder="" value="{{ request.POST.protocol }}">
        </div>
        <div class="form-group">
            <label for="duration">Duration:</label>
            <input type="text" id="duration" name="duration" class="form-control" placeholder="" value="{{ request.POST.duration }}">
        </div>
        <div class="form-group">
            <label for="data">Data:</label>
            <input type="text" id="data" name="data" class="form-control" placeholder="" value="{{ request.POST.data }}">
        </div>
        <div class="form-group">
            <label for="keyAlgs">Key Algorithms:</label>
            <input type="text" id="keyAlgs" name="keyAlgs" class="form-control" placeholder="" value="{{ request.POST.keyAlgs }}">
        </div>
        <div class="form-group">
            <label for="message">Message:</label>
            <input type="text" id="message" name="message" class="form-control" placeholder="" value="{{ request.POST.message }}">
        </div>
        <div class="form-group">
            <label for="eventid">Event ID:</label>
            <input type="text" id="eventid" name="eventid" class="form-control" placeholder="" value="{{ request.POST.eventid }}">
        </div>
        <div class="form-group">
            <label for="kexAlgs">Key Exchange Algorithms:</label>
            <input type="text" id="kexAlgs" name="kexAlgs" class="form-control" placeholder="" value="{{ request.POST.kexAlgs }}">
        </div>
        <button type="submit" class="btn btn-primary">Get Cowrie Log Attack Type</button>
    </div>
</form>
<br>

<!-- Display the classification result -->
{% if attack_type %}
    <h3>Attack Type:</h3>
    <div class="result">
        <p>{{ attack_type }}</p>
    </div>
    <br>
    <h3>Description:</h3>
    <div class="description-block">
        <p>{{ description }}</p>
    </div>
    <br>
{% endif %}

{% endblock %}
