{% extends "layout2.html" %}
{% block title %}Classification{% endblock %}

{% block content %}
<h1>Cowrie Log Attack Type Classification</h1>

{% comment %} <p class="comment">Please check your cowrie log data and enter! Note that you only need to fill in blocks with values!</p> {% endcomment %}
<p class="comment">Please check your Cowrie Log data and enter!</p>

<!-- Form to input parameters -->
<form method="POST" action="{% url 'ask_me:classification' %}">
    {% csrf_token %}
    <div class="form-flex">
        <label for="log_input">Paste Cowrie Log Data:</label>
        <textarea 
            id="log_input" 
            name="log_input" 
            class="form-control-class" 
            rows="3" 
            placeholder="Paste your cowrie log row here...">{{ request.POST.log_input }}</textarea>
    </div>
    <button type="submit" class="btn btn-primary">Get Cowrie Log Attack Type</button>
    <br><br>
</form>

{% if attack_type %}
    <hr>
    <h3>Attack Type:</h3>
    <div class="result">
        <p>{{ attack_type }}</p>
    </div>
    <h3>Description:</h3>
    <div class="description-block">
        <p>{{ description }}</p>
    </div>
{% elif error %}
    <hr>
    <div class="alert alert-danger">
        <p>{{ error }}</p>
    </div>
{% endif %}

{% endblock %}
